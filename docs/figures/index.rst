.. Copyright 2013-2018 The Salish Sea MEOPAR contributors
.. and The University of British Columbia
..
.. Licensed under the Apache License, Version 2.0 (the "License");
.. you may not use this file except in compliance with the License.
.. You may obtain a copy of the License at
..
..    http://www.apache.org/licenses/LICENSE-2.0
..
.. Unless required by applicable law or agreed to in writing, software
.. distributed under the License is distributed on an "AS IS" BASIS,
.. WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
.. See the License for the specific language governing permissions and
.. limitations under the License.

********************************
Results Figures for the Web Site
********************************

This section describes how figures are produced automatically from the results of nowcast system runs to appear on the daily pages that are linked from https://salishsea.eos.ubc.ca/nemo/results/.

In summary:

* Web site figures are generated by code modules stored in the :file:`nowcast/figure/` directory tree.
  See :ref:`FigureModulesOrganization` for details and links to docs about how to structure and write the functions in a figure module,
  and how to develop and test a figure module with the help of a Jupyter notebook.

* The :py:func:`make_figure` functions from figure modules are called in functions in the nowcast system :py:mod:`make_plots` worker.
  The figure object that a :py:func:`make_figure` function returns is rendered to storage on the :kbd:`salishsea.eos.ubc.ca` figures server.
  See :ref:`CallingMakeFigureFunctionsInTheMakePlotsWorker` for details of variables that the :py:mod:`make_plots` worker can provide to :py:func:`make_figure` functions,
  and how to store the figure to the figures server.

* The title of the figure and the name of the figure file are added to a list of web site figures.
  The title will appear on the results figures page linked from https://salishsea.eos.ubc.ca/nemo/results/.
  The figure file name is used to find the figure on the figures server.
  The list of figures is in the :py:mod:`salishsea_site.views.salishseacast` module of the `salishsea.eos.ubc.ca Site Web App`_.
  The figure titles and file names are added to the list as :py:class:`FigureMetadata` instances.
  See :ref:`SalishSeaCastWebPageViewFigureMetadata` for details of how to add figure titles and file names to the site web app view module.

  .. _salishsea.eos.ubc.ca Site Web App: https://salishsea-site.readthedocs.io/en/latest/

The :ref:`NowcastFiguresDevEnv` section below explains how to set up a conda environment that you can use to:

* develop figure modules
* test that the :py:mod:`make_plots` worker can render your figures to to the figures server
* test that the figure appears on a results page in the web app

.. toctree::
   :caption: In-Depth
   :maxdepth: 2

   fig_dev_env
   fig_modules
   create_fig_module
   website_theme
   make_figure_calls
   site_view_fig_metadata
   fig_module_tips
